{% extends "base.html" %}

{% block content %}
<div class="signals-section">
    <div class="section-header">
        <h2>ğŸ“ˆ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>
        {% if is_admin %}
        <div class="admin-badge">
            <span class="badge badge-admin">ğŸ‘‘ Ø§Ù„Ø£Ø¯Ù…Ù† - Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ({{ signals|length }} Ù…Ù† {{ all_signals_count }})</span>
        </div>
        {% elif is_logged_in %}
        <div class="plan-info">
            <span class="badge badge-{{ user.plan }}">Ø®Ø·Ø©: {{ user.plan|upper }} - Ø¹Ø±Ø¶ {{ signals|length }} Ø¥Ø´Ø§Ø±Ø©</span>
        </div>
        {% endif %}
    </div>

    <div id="signals-container">
        {% if signals %}
            {% for signal in signals %}
            <div class="signal-card {% if signal.signal_type == 'buy' or signal.rec == 'BUY' %}signal-buy{% else %}signal-sell{% endif %}">
                <div class="signal-header">
                    <div class="signal-pair">
                        <span class="pair-name">{{ signal.pair or signal.symbol }}</span>
                        <span class="signal-type {% if signal.signal_type == 'buy' or signal.rec == 'BUY' %}buy{% else %}sell{% endif %}">
                            {% if signal.signal_type == 'buy' or signal.rec == 'BUY' %}
                                ğŸ“ˆ Ø´Ø±Ø§Ø¡
                            {% else %}
                                ğŸ“‰ Ø¨ÙŠØ¹
                            {% endif %}
                        </span>
                    </div>
                    <div class="signal-quality">
                        <span class="quality-badge quality-{{ 'high' if signal.quality_score >= 80 else 'medium' if signal.quality_score >= 60 else 'low' }}">
                            â­ {{ signal.quality_score }}/100
                        </span>
                    </div>
                </div>

                <div class="signal-details">
                    <div class="detail-row">
                        <span class="detail-label">ğŸ’µ Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„:</span>
                        <span class="detail-value">{{ "%.5f"|format(signal.entry or signal.entry_price) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ğŸ›‘ ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©:</span>
                        <span class="detail-value stop-loss">{{ "%.5f"|format(signal.sl or signal.stop_loss) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£ÙˆÙ„:</span>
                        <span class="detail-value take-profit">{{ "%.5f"|format(signal.tp1 or signal.take_profit_1) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø«Ø§Ù†ÙŠ:</span>
                        <span class="detail-value take-profit">{{ "%.5f"|format(signal.tp2 or signal.take_profit_2) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø«Ø§Ù„Ø«:</span>
                        <span class="detail-value take-profit">{{ "%.5f"|format(signal.tp3 or signal.take_profit_3) }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">â±ï¸ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø²Ù…Ù†ÙŠ:</span>
                        <span class="detail-value">{{ signal.timeframe or '5m' }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ğŸ•’ Ø§Ù„ÙˆÙ‚Øª:</span>
                        <span class="detail-value">{{ signal.timestamp or signal.created_at }}</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø§Ø±Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
                {% if not is_logged_in %}
                <p>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª!</p>
                <a href="/login" class="btn btn-primary">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
                {% else %}
                <p>Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚</p>
                <p>ØªØ±Ù‚ÙŠØ© Ø®Ø·ØªÙƒ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª Ø£ÙƒØ«Ø±</p>
                <a href="/plans" class="btn btn-primary">Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·Ø·</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>

<style>
.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #eee;
}

.admin-badge .badge-admin {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 8px 15px;
    border-radius: 20px;
    font-weight: bold;
}

.badge {
    display: inline-block;
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 0.9em;
    font-weight: 600;
}

.badge-free { background: #95a5a6; color: white; }
.badge-bronze { background: #cd7f32; color: white; }
.badge-silver { background: #c0c0c0; color: #333; }
.badge-gold { background: #ffd700; color: #333; }
.badge-platinum { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }

.signals-section {
    padding: 20px;
}

.signal-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
}

.signal-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
}

.signal-buy {
    border-left: 5px solid #27ae60;
}

.signal-sell {
    border-left: 5px solid #e74c3c;
}

.signal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.signal-pair {
    display: flex;
    align-items: center;
    gap: 10px;
}

.pair-name {
    font-size: 1.5em;
    font-weight: bold;
    color: #2c3e50;
}

.signal-type {
    padding: 5px 15px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9em;
}

.signal-type.buy {
    background: #27ae60;
    color: white;
}

.signal-type.sell {
    background: #e74c3c;
    color: white;
}

.quality-badge {
    padding: 5px 12px;
    border-radius: 15px;
    font-weight: 600;
    font-size: 0.9em;
}

.quality-high {
    background: #27ae60;
    color: white;
}

.quality-medium {
    background: #f39c12;
    color: white;
}

.quality-low {
    background: #95a5a6;
    color: white;
}

.signal-details {
    display: grid;
    gap: 10px;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px dashed #eee;
}

.detail-label {
    font-weight: 600;
    color: #7f8c8d;
}

.detail-value {
    font-weight: 700;
    color: #2c3e50;
}

.detail-value.stop-loss {
    color: #e74c3c;
}

.detail-value.take-profit {
    color: #27ae60;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    background: #f8f9fa;
    border-radius: 12px;
}

.empty-state h3 {
    color: #7f8c8d;
    margin-bottom: 10px;
}

.empty-state p {
    color: #95a5a6;
    margin-bottom: 20px;
}

.btn {
    display: inline-block;
    padding: 12px 30px;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.btn-primary:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}
</style>

<script>
// ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
setInterval(function() {
    location.reload();
}, 30000);
</script>
{% endblock %}
